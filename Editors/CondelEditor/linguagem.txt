/* description: Parses end executes mathematical expressions. */

/* lexical grammar */
%lex
%%

\s+                   /* skip whitespace */

/* Reserved words */
/* ITU Classes */
'Bidirectional_CFTE'		return		'Bidirectional_CFTE'
'Bidirectional_Sink-Source_Matrix'		return		'Bidirectional_Sink-Source_Matrix'

/* ITU Relations */
'componentOf'		return		'componentOf'
'is_defined_by'		return		'is_defined_by'

'diff' return 'diff'
'same' return 'same'

/* Attributes */
'location'		return 'location'
'type'			return 'type'

'lat.deg'		return 'lat.deg'
'lat.min'		return 'lat.min'
'lat.sec'		return 'lat.sec'

'lon.deg'		return 'lon.deg'
'lon.min'		return 'lon.min'
'lon.sec'		return 'lon.sec'

/* Language constraints */
':'				return 'colon'
'.'				return 'dot'
';'				return 'semicolon'
'='				return 'equal'
','				return 'comma'
'{'				return 'l_curly_bracket'
'}'				return 'r_curly_bracket'
'('				return 'l_parenthesis'
')'				return 'r_parenthesis'

('-')?[0-9]+	return 'graus'
[A-Za-z_]+[0-9A-Za-z_]* return 'variable'
[0-9]+					return 'n_int'

"/*"(.|\n|\r)*?"*/"  /* ignore */           
<<EOF>>         return 'EOF'
.				return 'INVALID'

/lex


%start expressions

%% /* language grammar */

expressions
    : Instruction  EOF | Instruction  expressions
    ;
	
variable_declaration:
	variable | (variable comma  variable_declaration)
;

Instruction:
IndividualDeclaration | AttributeDeclaration | RelationDeclaration | DifferentFromDeclaration | SameAsDeclaration
;

IndividualDeclaration:
(Classes colon variable_declaration semicolon)
;

AttributeDeclaration:
	TypeDeclaration | LocationDeclaration | CoordinateDeclaration
;

TypeDeclaration:
	variable dot type colon variable semicolon
;

LocationDeclaration:
	variable dot location colon variable semicolon
;

CoordinateDeclaration:
(variable dot lat.deg colon graus semicolon) | 
(variable dot lat.min colon graus semicolon) | 
(variable dot lat.sec colon graus semicolon) | 

(variable dot lon.deg colon graus semicolon) | 
(variable dot lon.min colon graus semicolon) | 
(variable dot lon.sec colon graus semicolon)
;

RelationDeclaration:
	variable Relation variable_declaration semicolon
;

DifferentFromDeclaration:
	variable diff variable_declaration semicolon
;

SameAsDeclaration:
	variable same variable_declaration semicolon
;

Relation:
'componentOf' | 'is_defined_by'
;

Classes:
'Bidirectional_CFTE' | 'Bidirectional_Sink-Source_Matrix'
;

%%